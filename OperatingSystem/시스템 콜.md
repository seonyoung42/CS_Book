# 시스템 콜
> 커널 영역의 기능을 사용자 모드가 사용 가능하도록 권한을 주는 것

운영체제는 커널 모드와 사용자 모드로 나누어 구동된다. 

이 때 커널 모드의 기능을 사용자 모드에서 사용할 수 있도록 프로세스에게 하드웨어에 직접 접근하여 필요한 기능을 사용할 수 있는 권한을 주는 것을 **시스템 콜**이라고 한다.

운영체제가 처음 구동되면 초기화, 부팅을 위해 커널모드로 시작되고 이후 사용자 모드로 전환된다.

프로그램을 사용하면서 인터럽트나 트랩이 발생하면 운영체제의 모드가 커널 모드로 변경된다.

<br>

![image-5](https://github.com/seonyoung42/CS_Book/assets/77603632/123db3f1-b6d2-4042-8f91-aeb73fd45288)
- 커널 모드: 커널이 구동되는 환경으로 OS 시스템에 영향을 주는 명령어를 실행할 수 있다.
- 사용자 모드: 일반적인 응용프로그램이 구동되는 환경이다.

이와 같이 운영체제가 서로 다른 두가지 모드로 돌아가는 것을 **Dual Mode**로 작동한다고 말한다.

<br>

### 두 가지 모드로 분리하는 이유?
> 사용자 모드와 커널 모드의 구분이 없다면 응용프로그램이 OS에 접근할 수 있기 때문이다. 
> 
> 운영체제는 시스템에 영향을 미칠 수 있는 몇 가지 명령어를 특권 명령으로 지정하여 운영체제 스스로를 보호한다. 
> 만약 응용 프로그램이 해당 명령어를 시행하려고 한다면 운영체제가 트랩을 걸어 프로그램을 중단 시킬 수 있다.

- 특권 명령: 보안이 필요한 명령으로 운영체제만 수행할 수 있는 명령
- 일반 명령: 메모리에서 자료를 읽어오고, CPU에서 계산을 하는 것과 같이 모든 프로그램이 수행할 수 있는 명령

<br>

## 시스템 콜 처리 과정
> 프로세스 A 실행 중 디스크에서 어떤 데이터를 읽어오라는 명령을 받은 경우

1. 사용자 프로그램은 해당 명령(=특권 명령)을 수행할 수 없기 때문에 운영체제에게 **시스템 콜을** 통해 해당 명령을 대신 수행해달라고 요청
2. 프로그램이 인터럽트 라인에 인터럽트를 세팅
3. CPU가 인터럽트 라인을 검사하고 인터럽트의 발생 감지
4. 현재 수행중인 사용자 프로그램을 멈추고 CPU제어권을 운영체제에게 양도 => 커널 모드
5. 이 때, 하드웨어적으로 비트가 1에서 0으로 자동으로 세팅되어 특권 명령 수행

