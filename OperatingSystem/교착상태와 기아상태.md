# 교착상태(Dead Lock)
> 프로세스나 스레드가 서로 자원을 얻지 못해 다음 처리를 하지 못하는 상태

두 개 이상의 프로세스나 스레드가 있을 때, 원하는 자원이 상대방에게 할당되어 있어 무한정 대기 상태에 빠지는 것으로 시스템적으로 한정된 자원을 여러 곳에서 사용하려고 할 때 발생한다. 

<br>

## 교착상태 발생 조건
아래의 네 가지 조건이 모두 충족되면 교착상태가 발생한다

#### 1. 상호 배제
> 자원은 한 번에 하나의 프로세스만 사용 가능

#### 2. 점유 대기
> 최소 하나의 자원을 점유하면서 다른 프로세스에 할당되어 있는 자원을 추가로 점유하기 위해 대기

#### 3. 비선점
> 다른 프로세스에 할당되 자원으 사용이 끝날 때까지 강제로 뺏을 수 없음

#### 4. 순환 대기
> 프로세스 간에 사이클이 형성되어 순환 형태로 자원을 대기

<br>

## 교착상태 해결 방법
### 1. 예방(Deadlock Prevention)
> 자원 할당 시 데드락의 발생 조건 중 어느 하나가 만족되지 않도록 하는 방법
> 
> 비 효율적이며, starvation(기아상태)발생할 수 있음
-  상호배제 부정: 한 번에 여러 프로세스가 공유 자원 사용할 수 있게 함
-  점유대기 부정: 프로세스가 자원을 요청할 때 다른 어떤 자원도 가지고 있지 않도록 함
-  비선점 부정: 프로세스가 어떤 자원을 기다려야하는 경우 점유하고 있던 자원 반납함
-  순환대기 부정: 프로세스마다 할당 순서를 정하고 정해진 순서대로만 자원 할당

<br>

### 2. 회피(Deadlock Avoidance)
> 데드락이 발생할 가능성이 있는 경우 자원을 할당하지 않는 방법

#### - 자원 할당 알고리즘
![image-6](https://github.com/seonyoung42/CS_Book/assets/77603632/06641bd9-0e1c-4420-a3d8-d751b120f1ad)
- 점선 : 프로세스가 지원을 미래에 요청할 수 있음(Claim edge)
- 실선 : 자원을 요청하는 경우 점선에서 실선으로 바뀜(Request edge)
- 방향이 반대인 실선 : 자원이 할당 됨(Assignment edge)
    - 자원을 다쓰고 반납하면 점선으로 바뀜

교착상태를 피하기 위해서 실선의 방향이 반대로 변경될 때 점선을 포함해서 사이클이 생기지 않는 경우에만 자원을 할당한다. (이미지 예시는 사이클이 생긴 경우임)

<br>

#### - 은행원 알고리즘
> 대기중인 프로세스들의 활동에 대해서 시뮬레이션을 통해 안전 상태에 들 수 있는지, 교착상태 가능성을 미리 조사하는 알고리즘

- 안전 상태 : 교착상태에 빠지지 않으면서 프로세스들이 요구한 모든 자원을 할당해줄 수 있는 상태
- 불안전 상태 : 안전 순서열이 존재하지 않는 상태로 교착상태가 발생하기 위한 필요조건

<br>

### 3. 탐지 및 회복(Deadlock Detection and recovery)
> 데드락 발생은 허용하되, 탐지 루틴을 두어 데드락 발견시 회복할 수 있도록 하는 방법

<br>

### 4. 무시 (Deadlock Ignorance)
> 데드락을 시스템이 책임지지 않음
> UNIX를 포함한 대부분의 OS가 채택

<br>

# 기아상태(starvation)
> 특정 프로세스의 우선순위가 낮아서 원하는 자원을 계속 할당 받지 못하는 상태

<br>

## 기아상태 해결 방법
+ 프로세스 우선순위를 수시로 변경하여 각 프로세스가 높은 우선순위를 가질 수 있게 함
+ 오래 기다린 프로세스의 우선순위 높임
+ 우선순위가 아닌 요청 순서대로 처리하는 요청큐 사용

<br>

## 교착상태 vs 기아상태
> 교착상태 : 여러 프로세스가 동일 자원 점유를 요청할 때 발생
> 
> 기아상태 : 여러 프로세스가 부족한 자원을 점유하기 위해 경쟁할 때 발생
